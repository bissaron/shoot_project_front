{"ast":null,"code":"import Swal from \"sweetalert2\";\nexport default {\n  data() {\n    return {\n      user: {\n        username: \"\",\n        password: \"\",\n        confirmPassword: \"\",\n        role: \"customer\",\n        fname: \"\",\n        lname: \"\",\n        tel: \"\"\n      },\n      roles: [\"customer\", \"admin\"],\n      passwordMatchRule: [v => !!v || \"กรุณากรอกยืนยันรหัสผ่าน\", v => v === this.user.password || \"รหัสผ่านไม่ตรงกัน\"],\n      Rules: {\n        telephoneRules: [v => !!v || \"กรุณากรอกหมายเลขโทรศัพท์\", v => /^0[0-9]{2}-[0-9]{3}-[0-9]{4}$/.test(v) || \"รูปแบบหมายเลขโทรศัพท์ไม่ถูกต้อง (เช่น 099-999-9999)\"]\n      },\n      showTextField: false\n    };\n  },\n  watch: {\n    \"user.role\": function (newRole) {\n      if (newRole === \"admin\") {\n        this.showTextField = true;\n        console.log(\"admin\");\n      } else {\n        this.showTextField = false;\n        console.log(\"customer\");\n      }\n    }\n  },\n  computed: {\n    passwordsDoNotMatch() {\n      return this.user.password !== this.user.confirmPassword;\n    }\n  },\n  methods: {\n    async addUser() {\n      if (this.passwordsDoNotMatch) {\n        Swal.fire({\n          title: \"รหัสผ่านไม่ตรงกัน!\",\n          icon: \"error\",\n          // confirmButtonText: \"ตกลง\",\n          showConfirmButton: false,\n          timer: 1000\n        });\n        return;\n      }\n      try {\n        let userData = {};\n        if (this.user.role == \"admin\") {\n          userData = {\n            username: this.user.username,\n            password: this.user.password,\n            role: this.user.role,\n            a_fname: this.user.fname,\n            o_lname: this.user.lname\n          };\n        } else {\n          userData = {\n            username: this.user.username,\n            password: this.user.password,\n            role: this.user.role,\n            c_fname: this.user.fname,\n            c_lname: this.user.lname,\n            c_tel: this.user.tel\n          };\n        }\n        const response = await this.axios.post(process.env.VUE_APP_API_SERVER + `/user`, userData);\n        if (response.status === 201) {\n          Swal.fire({\n            title: \"เพิ่มผู้ใช้สำเร็จ!\",\n            // text: \"คุณสมัครสมาชิกสำเร็จ\",\n            icon: \"success\",\n            confirmButtonText: \"ตกลง\",\n            timer: 1500\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        Swal.fire({\n          title: \"ชื่อผู้ใช้ไม่พร้อมใช้งาน!\",\n          icon: \"error\",\n          text: \"กรุณาใช้ชื่อผู้ใช้อื่น\",\n          confirmButtonText: \"ตกลง\"\n          //   showConfirmButton: false,\n          //   timer: 1000,\n        });\n\n        console.error(\"Registration error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n\n    getRole(value) {\n      console.log(\"value\", value);\n    }\n  }\n};","map":{"version":3,"names":["Swal","data","user","username","password","confirmPassword","role","fname","lname","tel","roles","passwordMatchRule","v","Rules","telephoneRules","test","showTextField","watch","user.role","newRole","console","log","computed","passwordsDoNotMatch","methods","addUser","fire","title","icon","showConfirmButton","timer","userData","a_fname","o_lname","c_fname","c_lname","c_tel","response","axios","post","process","env","VUE_APP_API_SERVER","status","confirmButtonText","$router","go","error","text","getRole","value"],"sources":["src/views/UserAddView.vue"],"sourcesContent":["<template>\n  <v-container style=\"padding-top: 50px; padding-bottom: 60px\">\n    <v-btn text @click=\"$router.go(-1)\" style=\"margin-bottom: 20px\">\n      <v-icon left>mdi-arrow-left</v-icon> ย้อนกลับ\n    </v-btn>\n    <v-row justify=\"center\">\n      <v-col cols=\"12\" xs=\"10\" sm=\"10\" md=\"12\">\n        <v-card style=\"padding: 20px\">\n          <v-container>\n            <v-form @submit.prevent=\"addUser\">\n              <v-row>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <h2>{{ !showTextField ? \"เพิ่มลูกค้า\" : \"เพิ่มเจ้าของ\" }}</h2>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"12\">\n                  <v-select\n                    v-model=\"user.role\"\n                    :items=\"roles\"\n                    label=\"บทบาท\"\n                    required\n                  ></v-select>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <v-text-field\n                    v-model=\"user.username\"\n                    label=\"ชื่อผู้ใช้\"\n                    required\n                  ></v-text-field>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <v-text-field\n                    v-model=\"user.password\"\n                    label=\"รหัสผ่าน\"\n                    type=\"password\"\n                    required\n                  ></v-text-field>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <v-text-field\n                    v-model=\"user.confirmPassword\"\n                    label=\"ยืนยันรหัสผ่าน\"\n                    type=\"password\"\n                    :rules=\"passwordMatchRule\"\n                  >\n                    <template v-slot:error=\"{ messages }\">\n                      <span class=\"red--text\">{{ messages.join(\". \") }}</span>\n                    </template>\n                  </v-text-field>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <v-text-field\n                    v-model=\"user.fname\"\n                    label=\"ชื่อจริง\"\n                    required\n                  ></v-text-field>\n                </v-col>\n                <v-col cols=\"12\" sm=\"12\" md=\"4\">\n                  <v-text-field\n                    v-model=\"user.lname\"\n                    label=\"นามสกุล\"\n                    required\n                  ></v-text-field>\n                </v-col>\n\n                <v-col cols=\"12\" sm=\"12\" md=\"4\" v-if=\"!showTextField\">\n                  <v-text-field\n                    v-model=\"user.tel\"\n                    label=\"เบอร์มือถือ\"\n                    required\n                    :rules=\"Rules.telephoneRules\"\n                  ></v-text-field>\n                </v-col>\n              </v-row>\n              <div style=\"display: flex; justify-content: flex-end; align-items: center; margin-top: 10px\">\n              <v-btn color=\"primary\" @click=\"addUser()\">ยืนยัน</v-btn>\n              <v-btn style=\"margin-left: 10px\" @click=\"$router.go(-1)\">ยกเลิก</v-btn>\n            </div>\n            </v-form>\n          </v-container>\n        </v-card>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script>\nimport Swal from \"sweetalert2\";\n\nexport default {\n  data() {\n    return {\n      user: {\n        username: \"\",\n        password: \"\",\n        confirmPassword: \"\",\n        role: \"customer\",\n        fname: \"\",\n        lname: \"\",\n        tel: \"\",\n      },\n      roles: [\"customer\", \"admin\"],\n      passwordMatchRule: [\n        (v) => !!v || \"กรุณากรอกยืนยันรหัสผ่าน\",\n        (v) => v === this.user.password || \"รหัสผ่านไม่ตรงกัน\",\n      ],\n      Rules: {\n        telephoneRules: [\n          (v) => !!v || \"กรุณากรอกหมายเลขโทรศัพท์\",\n          (v) =>\n            /^0[0-9]{2}-[0-9]{3}-[0-9]{4}$/.test(v) ||\n            \"รูปแบบหมายเลขโทรศัพท์ไม่ถูกต้อง (เช่น 099-999-9999)\",\n        ],\n      },\n      showTextField: false,\n    };\n  },\n  watch: {\n    \"user.role\": function (newRole) {\n      if (newRole === \"admin\") {\n        this.showTextField = true;\n        console.log(\"admin\");\n      } else {\n        this.showTextField = false;\n        console.log(\"customer\");\n      }\n    },\n  },\n  computed: {\n    passwordsDoNotMatch() {\n      return this.user.password !== this.user.confirmPassword;\n    },\n  },\n  methods: {\n    async addUser() {\n      if (this.passwordsDoNotMatch) {\n        Swal.fire({\n          title: \"รหัสผ่านไม่ตรงกัน!\",\n          icon: \"error\",\n          // confirmButtonText: \"ตกลง\",\n          showConfirmButton: false,\n          timer: 1000,\n        });\n        return;\n      }\n\n      try {\n        let userData = {};\n        if (this.user.role == \"admin\") {\n          userData = {\n            username: this.user.username,\n            password: this.user.password,\n            role: this.user.role,\n            a_fname: this.user.fname,\n            o_lname: this.user.lname,\n          };\n        } else {\n          userData = {\n            username: this.user.username,\n            password: this.user.password,\n            role: this.user.role,\n            c_fname: this.user.fname,\n            c_lname: this.user.lname,\n            c_tel: this.user.tel,\n          };\n        }\n        const response = await this.axios.post(\n          process.env.VUE_APP_API_SERVER + `/user`,\n          userData\n        );\n        if (response.status === 201) {\n          Swal.fire({\n            title: \"เพิ่มผู้ใช้สำเร็จ!\",\n            // text: \"คุณสมัครสมาชิกสำเร็จ\",\n            icon: \"success\",\n            confirmButtonText: \"ตกลง\",\n            timer: 1500,\n          });\n          this.$router.go(-1);\n        }\n      } catch (error) {\n        Swal.fire({\n          title: \"ชื่อผู้ใช้ไม่พร้อมใช้งาน!\",\n          icon: \"error\",\n          text: \"กรุณาใช้ชื่อผู้ใช้อื่น\",\n          confirmButtonText: \"ตกลง\",\n        //   showConfirmButton: false,\n        //   timer: 1000,\n        });\n        console.error(\"Registration error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n    getRole(value) {\n      console.log(\"value\", value);\n    },\n  },\n};\n</script>\n"],"mappings":"AAsFA,OAAAA,IAAA;AAEA;EACAC,KAAA;IACA;MACAC,IAAA;QACAC,QAAA;QACAC,QAAA;QACAC,eAAA;QACAC,IAAA;QACAC,KAAA;QACAC,KAAA;QACAC,GAAA;MACA;MACAC,KAAA;MACAC,iBAAA,GACAC,CAAA,MAAAA,CAAA,+BACAA,CAAA,IAAAA,CAAA,UAAAV,IAAA,CAAAE,QAAA,wBACA;MACAS,KAAA;QACAC,cAAA,GACAF,CAAA,MAAAA,CAAA,gCACAA,CAAA,IACA,gCAAAG,IAAA,CAAAH,CAAA,KACA;MAEA;MACAI,aAAA;IACA;EACA;EACAC,KAAA;IACA,sBAAAC,CAAAC,OAAA;MACA,IAAAA,OAAA;QACA,KAAAH,aAAA;QACAI,OAAA,CAAAC,GAAA;MACA;QACA,KAAAL,aAAA;QACAI,OAAA,CAAAC,GAAA;MACA;IACA;EACA;EACAC,QAAA;IACAC,oBAAA;MACA,YAAArB,IAAA,CAAAE,QAAA,UAAAF,IAAA,CAAAG,eAAA;IACA;EACA;EACAmB,OAAA;IACA,MAAAC,QAAA;MACA,SAAAF,mBAAA;QACAvB,IAAA,CAAA0B,IAAA;UACAC,KAAA;UACAC,IAAA;UACA;UACAC,iBAAA;UACAC,KAAA;QACA;QACA;MACA;MAEA;QACA,IAAAC,QAAA;QACA,SAAA7B,IAAA,CAAAI,IAAA;UACAyB,QAAA;YACA5B,QAAA,OAAAD,IAAA,CAAAC,QAAA;YACAC,QAAA,OAAAF,IAAA,CAAAE,QAAA;YACAE,IAAA,OAAAJ,IAAA,CAAAI,IAAA;YACA0B,OAAA,OAAA9B,IAAA,CAAAK,KAAA;YACA0B,OAAA,OAAA/B,IAAA,CAAAM;UACA;QACA;UACAuB,QAAA;YACA5B,QAAA,OAAAD,IAAA,CAAAC,QAAA;YACAC,QAAA,OAAAF,IAAA,CAAAE,QAAA;YACAE,IAAA,OAAAJ,IAAA,CAAAI,IAAA;YACA4B,OAAA,OAAAhC,IAAA,CAAAK,KAAA;YACA4B,OAAA,OAAAjC,IAAA,CAAAM,KAAA;YACA4B,KAAA,OAAAlC,IAAA,CAAAO;UACA;QACA;QACA,MAAA4B,QAAA,cAAAC,KAAA,CAAAC,IAAA,CACAC,OAAA,CAAAC,GAAA,CAAAC,kBAAA,YACAX,QACA;QACA,IAAAM,QAAA,CAAAM,MAAA;UACA3C,IAAA,CAAA0B,IAAA;YACAC,KAAA;YACA;YACAC,IAAA;YACAgB,iBAAA;YACAd,KAAA;UACA;UACA,KAAAe,OAAA,CAAAC,EAAA;QACA;MACA,SAAAC,KAAA;QACA/C,IAAA,CAAA0B,IAAA;UACAC,KAAA;UACAC,IAAA;UACAoB,IAAA;UACAJ,iBAAA;UACA;UACA;QACA;;QACAxB,OAAA,CAAA2B,KAAA,wBAAAA,KAAA;QACA;MACA;IACA;;IACAE,QAAAC,KAAA;MACA9B,OAAA,CAAAC,GAAA,UAAA6B,KAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}