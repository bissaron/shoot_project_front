{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Swal from \"sweetalert2\";\nexport default {\n  name: \"LoginView\",\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      telephone: \"\",\n      isLogin: true,\n      Rules: {\n        usernameRules: [v => !!v || \"กรุณากรอกชื่อผู้ใช้งาน\"],\n        passwordRules: [v => !!v || \"กรุณากรอกรหัสผ่าน\"],\n        firstNameRules: [v => !!v || \"กรุณากรอกชื่อ\"],\n        lastNameRules: [v => !!v || \"กรุณากรอกนามสกุล\"],\n        telephoneRules: [v => !!v || \"กรุณากรอกหมายเลขโทรศัพท์\", v => {\n          const formattedNumber = v.replace(/^(\\d{3})/, \"$1-\");\n          const isValidFormat = /^[0-9]{3}-[0-9]{3}-[0-9]{4}$/.test(formattedNumber);\n          if (!isValidFormat) {\n            return \"รูปแบบหมายเลขโทรศัพท์ไม่ถูกต้อง (เช่น 123-456-7890)\";\n          }\n          return true;\n        }]\n      },\n      passwordMatchRule: [v => !!v || \"กรุณากรอกยืนยันรหัสผ่าน\", v => v === this.password || \"รหัสผ่านไม่ตรงกัน\"]\n    };\n  },\n  methods: {\n    async login() {\n      try {\n        const data = {\n          username: this.username,\n          password: this.password\n        };\n        const response = await this.axios.post(process.env.VUE_APP_API_SERVER + `/login`, data);\n        if (response.status === 200) {\n          localStorage.setItem(\"auth\", JSON.stringify(response.data));\n          this.$router.push(\"/\").then(() => window.location.reload());\n        }\n      } catch (error) {\n        Swal.fire({\n          title: \"เข้าสู่ระบบไม่สำเร็จ!\",\n          text: \"โปรดตรวจสอบชื่อผู้ใช้และรหัสผ่านอีกครั้ง\",\n          icon: \"error\",\n          confirmButtonText: \"ตกลง\"\n          // timer: 1500\n        });\n\n        console.error(\"Login error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n\n    async register() {\n      if (this.password !== this.confirmPassword) {\n        // Passwords do not match\n        // Handle the error, e.g., show an error message\n        return;\n      }\n      try {\n        const data = {\n          username: this.username,\n          password: this.password,\n          role: \"customer\",\n          c_fname: this.firstName,\n          c_lname: this.lastName,\n          c_tel: this.telephone\n        };\n        const response = await this.axios.post(process.env.VUE_APP_API_SERVER + `/register`, data);\n        if (response.status === 201) {\n          Swal.fire({\n            title: \"สมัครสมาชิกสำเร็จ!\",\n            text: \"คุณสมัครสมาชิกสำเร็จ\",\n            icon: \"success\",\n            confirmButtonText: \"ตกลง\"\n            // timer: 1500\n          }).then(() => window.location.reload());\n        }\n      } catch (error) {\n        Swal.fire({\n          title: \"เกิดข้อผิดพลาด!\",\n          // text: \"คุณสมัครสมาชิกสำเร็จ\",\n          icon: \"error\",\n          confirmButtonText: \"ตกลง\",\n          timer: 1500\n        });\n        console.error(\"Registration error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n\n    toggleView() {\n      this.isLogin = !this.isLogin;\n      this.username = \"\";\n      this.password = \"\";\n      this.confirmPassword = \"\";\n      this.firstName = \"\";\n      this.lastName = \"\";\n      this.telephone = \"\";\n    }\n  }\n};","map":{"version":3,"names":["Swal","name","data","username","password","confirmPassword","firstName","lastName","telephone","isLogin","Rules","usernameRules","v","passwordRules","firstNameRules","lastNameRules","telephoneRules","formattedNumber","replace","isValidFormat","test","passwordMatchRule","methods","login","response","axios","post","process","env","VUE_APP_API_SERVER","status","localStorage","setItem","JSON","stringify","$router","push","then","window","location","reload","error","fire","title","text","icon","confirmButtonText","console","register","role","c_fname","c_lname","c_tel","timer","toggleView"],"sources":["src/views/LoginView.vue"],"sourcesContent":["<template >\n  <v-container fluid>\n    <v-row justify=\"center\" >\n      <v-col cols=\"12\" xs=\"10\" sm=\"10\" md=\"4\" >\n        <v-card style=\"margin: 20px;\">\n          <v-container>\n            <v-card-title>{{\n              isLogin ? \"เข้าสู่ระบบ\" : \"สมัครสมาชิก\"\n            }}</v-card-title>\n            <v-card-text>\n              <v-form @submit.prevent=\"isLogin ? login : register\">\n                <v-text-field\n                  v-model=\"username\"\n                  label=\"ชื่อผู้ใช้\"\n                  required\n                  :rules=\"Rules.usernameRules\"\n                ></v-text-field>\n                <v-text-field\n                  v-model=\"password\"\n                  label=\"รหัสผ่าน\"\n                  type=\"password\"\n                  required\n                  :rules=\"Rules.passwordRules\"\n                ></v-text-field>\n                <!-- Confirmation password field with matching rule -->\n                <v-text-field\n                  v-model=\"confirmPassword\"\n                  label=\"ยืนยันรหัสผ่าน\"\n                  type=\"password\"\n                  v-if=\"!isLogin\"\n                  :rules=\"passwordMatchRule\"\n                >\n                  <template v-slot:error=\"{ messages }\">\n                    <span class=\"red--text\">{{ messages.join(\". \") }}</span>\n                  </template>\n                </v-text-field>\n                <!-- Additional registration fields with rules -->\n                <v-text-field\n                  v-model=\"firstName\"\n                  label=\"ชื่อจริง\"\n                  required\n                  v-if=\"!isLogin\"\n                  :rules=\"Rules.firstNameRules\"\n                ></v-text-field>\n                <v-text-field\n                  v-model=\"lastName\"\n                  label=\"นามสกุล\"\n                  required\n                  v-if=\"!isLogin\"\n                  :rules=\"Rules.lastNameRules\"\n                ></v-text-field>\n                <v-text-field\n                  v-model=\"telephone\"\n                  label=\"เบอร์มือถือ\"\n                  required\n                  v-if=\"!isLogin\"\n                  :rules=\"Rules.telephoneRules\"\n                ></v-text-field>\n\n                <v-col style=\"display: flex; justify-content: center; align-items: center;\">\n                  <v-btn\n                    color=\"primary\"\n                    @click=\"isLogin ? login() : register()\"\n                  >\n                    {{ isLogin ? \"เข้าสู่ระบบ\" : \"สมัครสมาชิก\" }}\n                  </v-btn>\n                </v-col>\n                <v-col style=\"display: flex; justify-content: flex-end; align-items: center;\">\n                  <a @click=\"toggleView\">{{\n                    isLogin ? \"สมัครสมาชิก\" : \"เข้าสู่ระบบ\"\n                  }}</a>\n                </v-col>\n              </v-form>\n            </v-card-text>\n          </v-container>\n        </v-card>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script>\nimport Swal from \"sweetalert2\";\n\nexport default {\n  name: \"LoginView\",\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      telephone: \"\",\n      isLogin: true,\n      Rules: {\n        usernameRules: [(v) => !!v || \"กรุณากรอกชื่อผู้ใช้งาน\"],\n        passwordRules: [(v) => !!v || \"กรุณากรอกรหัสผ่าน\"],\n        firstNameRules: [(v) => !!v || \"กรุณากรอกชื่อ\"],\n        lastNameRules: [(v) => !!v || \"กรุณากรอกนามสกุล\"],\n        telephoneRules: [\n  (v) => !!v || \"กรุณากรอกหมายเลขโทรศัพท์\",\n  (v) => {\n    const formattedNumber = v.replace(/^(\\d{3})/, \"$1-\");\n    const isValidFormat = /^[0-9]{3}-[0-9]{3}-[0-9]{4}$/.test(formattedNumber);\n    if (!isValidFormat) {\n      return \"รูปแบบหมายเลขโทรศัพท์ไม่ถูกต้อง (เช่น 123-456-7890)\";\n    }\n    return true;\n  },\n],\n      },\n      passwordMatchRule: [\n        (v) => !!v || \"กรุณากรอกยืนยันรหัสผ่าน\",\n        (v) => v === this.password || \"รหัสผ่านไม่ตรงกัน\",\n      ],\n    };\n  },\n  methods: {\n    async login() {\n      try {\n        const data = { username: this.username, password: this.password };\n        const response = await this.axios.post(\n          process.env.VUE_APP_API_SERVER + `/login`,\n          data\n        );\n        if (response.status === 200) {\n          localStorage.setItem(\"auth\", JSON.stringify(response.data));\n          this.$router.push(\"/\").then(()=>window.location.reload())\n        }\n      } catch (error) {\n        Swal.fire({\n            title: \"เข้าสู่ระบบไม่สำเร็จ!\",\n            text: \"โปรดตรวจสอบชื่อผู้ใช้และรหัสผ่านอีกครั้ง\",\n            icon: \"error\",\n            confirmButtonText: \"ตกลง\",\n            // timer: 1500\n          })\n        console.error(\"Login error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n\n    async register() {\n      if (this.password !== this.confirmPassword) {\n        // Passwords do not match\n        // Handle the error, e.g., show an error message\n        return;\n      }\n\n      try {\n        const data = {\n          username: this.username,\n          password: this.password,\n          role: \"customer\",\n          c_fname: this.firstName,\n          c_lname: this.lastName,\n          c_tel: this.telephone,\n        };\n        const response = await this.axios.post(\n          process.env.VUE_APP_API_SERVER + `/register`,\n          data\n        );\n        if (response.status === 201) {\n          Swal.fire({\n            title: \"สมัครสมาชิกสำเร็จ!\",\n            text: \"คุณสมัครสมาชิกสำเร็จ\",\n            icon: \"success\",\n            confirmButtonText: \"ตกลง\",\n            // timer: 1500\n          }).then(() => window.location.reload());\n        }\n      } catch (error) {\n        Swal.fire({\n              title: \"เกิดข้อผิดพลาด!\",\n              // text: \"คุณสมัครสมาชิกสำเร็จ\",\n              icon: \"error\",\n              confirmButtonText: \"ตกลง\",\n              timer: 1500,\n            });\n        console.error(\"Registration error:\", error);\n        // You can display an error message to the user here\n      }\n    },\n\n    toggleView() {\n      this.isLogin = !this.isLogin;\n      this.username = \"\";\n      this.password = \"\";\n      this.confirmPassword = \"\";\n      this.firstName = \"\";\n      this.lastName = \"\";\n      this.telephone = \"\";\n    },\n  },\n};\n</script>\n\n<style scoped>\na:hover {\n  text-decoration: none;\n  color: var(--color-main);\n}\n</style>\n"],"mappings":";AAkFA,OAAAA,IAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,QAAA;MACAC,eAAA;MACAC,SAAA;MACAC,QAAA;MACAC,SAAA;MACAC,OAAA;MACAC,KAAA;QACAC,aAAA,GAAAC,CAAA,MAAAA,CAAA;QACAC,aAAA,GAAAD,CAAA,MAAAA,CAAA;QACAE,cAAA,GAAAF,CAAA,MAAAA,CAAA;QACAG,aAAA,GAAAH,CAAA,MAAAA,CAAA;QACAI,cAAA,GACAJ,CAAA,MAAAA,CAAA,gCACAA,CAAA;UACA,MAAAK,eAAA,GAAAL,CAAA,CAAAM,OAAA;UACA,MAAAC,aAAA,kCAAAC,IAAA,CAAAH,eAAA;UACA,KAAAE,aAAA;YACA;UACA;UACA;QACA;MAEA;MACAE,iBAAA,GACAT,CAAA,MAAAA,CAAA,+BACAA,CAAA,IAAAA,CAAA,UAAAR,QAAA;IAEA;EACA;EACAkB,OAAA;IACA,MAAAC,MAAA;MACA;QACA,MAAArB,IAAA;UAAAC,QAAA,OAAAA,QAAA;UAAAC,QAAA,OAAAA;QAAA;QACA,MAAAoB,QAAA,cAAAC,KAAA,CAAAC,IAAA,CACAC,OAAA,CAAAC,GAAA,CAAAC,kBAAA,aACA3B,IACA;QACA,IAAAsB,QAAA,CAAAM,MAAA;UACAC,YAAA,CAAAC,OAAA,SAAAC,IAAA,CAAAC,SAAA,CAAAV,QAAA,CAAAtB,IAAA;UACA,KAAAiC,OAAA,CAAAC,IAAA,MAAAC,IAAA,OAAAC,MAAA,CAAAC,QAAA,CAAAC,MAAA;QACA;MACA,SAAAC,KAAA;QACAzC,IAAA,CAAA0C,IAAA;UACAC,KAAA;UACAC,IAAA;UACAC,IAAA;UACAC,iBAAA;UACA;QACA;;QACAC,OAAA,CAAAN,KAAA,iBAAAA,KAAA;QACA;MACA;IACA;;IAEA,MAAAO,SAAA;MACA,SAAA5C,QAAA,UAAAC,eAAA;QACA;QACA;QACA;MACA;MAEA;QACA,MAAAH,IAAA;UACAC,QAAA,OAAAA,QAAA;UACAC,QAAA,OAAAA,QAAA;UACA6C,IAAA;UACAC,OAAA,OAAA5C,SAAA;UACA6C,OAAA,OAAA5C,QAAA;UACA6C,KAAA,OAAA5C;QACA;QACA,MAAAgB,QAAA,cAAAC,KAAA,CAAAC,IAAA,CACAC,OAAA,CAAAC,GAAA,CAAAC,kBAAA,gBACA3B,IACA;QACA,IAAAsB,QAAA,CAAAM,MAAA;UACA9B,IAAA,CAAA0C,IAAA;YACAC,KAAA;YACAC,IAAA;YACAC,IAAA;YACAC,iBAAA;YACA;UACA,GAAAT,IAAA,OAAAC,MAAA,CAAAC,QAAA,CAAAC,MAAA;QACA;MACA,SAAAC,KAAA;QACAzC,IAAA,CAAA0C,IAAA;UACAC,KAAA;UACA;UACAE,IAAA;UACAC,iBAAA;UACAO,KAAA;QACA;QACAN,OAAA,CAAAN,KAAA,wBAAAA,KAAA;QACA;MACA;IACA;;IAEAa,WAAA;MACA,KAAA7C,OAAA,SAAAA,OAAA;MACA,KAAAN,QAAA;MACA,KAAAC,QAAA;MACA,KAAAC,eAAA;MACA,KAAAC,SAAA;MACA,KAAAC,QAAA;MACA,KAAAC,SAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}